# 为什么又一款包管理？

::: warning 注意
本文内容有较强的主观色彩。
:::

## 背景

社区中已存在多款较为成熟的 Windows 包管理方案，其中最为知名的是 [Chocolatey](https://chocolatey.org) 和 [Scoop](https://scoop.sh)，它们已经发展多年并积累了一定数量的用户。同时，来自 Microsoft 官方团队的 [winget](https://github.com/microsoft/winget-cli) 也已正式推出，并处于高速发展阶段。在这样的背景下，又一款包管理程序是否还有出现的必要？

我想在此讲讲本项目产生的动机。

## Windows 和包管理

上文提及的三个项目我均有使用过，并且个人是 Scoop 的长期用户，非常喜欢其设计。但在分析了以上三款优秀的开源作品后，我必须要阐述一个事实：

**Windows 平台不适合使用统一的软件包管理来管理大部分应用。**

原因有以下几点：

- Windows 应用以桌面应用为主，这些应用大多自己维护版本管理并提供自动更新；
- Windows 开发者大多应用选择静态链接或打包库文件的方式进行分发，不会产生复杂的依赖关系；
- Windows 的注册表机制导致几乎不可能优雅地实现以包为粒度的包管理系统；
- Windows 平台下应用部署方式的多样性、沉重的历史包袱以及许可证等问题导致难以实现中心化的软件仓库；
- Microsoft 建议使用 MSIX 或 MSI 安装包方式分发应用，这一安装过程是难以干预的。而实际上它们的设计也都非常优秀，并且更符合 Windows 的哲学。

其实下载并运行安装包，才是更加 Windows 的软件安装方式，也是目前大部分桌面应用首选的分发方式，至于安装包需要进入官网寻找下载链接的问题，正是 winget 打算解决的问题。

那么类 UNIX 风格的包管理在 Windows 上有没有存在的必要，这个问题不同的人有不同的答案。就我个人而言，使用包管理接管一些开发工具、CLI 应用等还是非常方便的。但用来安装桌面应用显然不合适，因为 Windows 已经内置了非常优秀的应用程序部署和管理系统。

## 现存方案的问题

Scoop 的设计非常轻量化，架构简单而巧妙，但其存在诸多难以解决的问题，其中最主要的一点是由于其使用 PowerShell 构建，性能低下且难以维护，此外还存在一些由于发展过于快速而产生的不佳设计，导致仓库质量参差不齐且难以修改。

winget 是微软官方团队的项目，相比于社区项目拥有更高的关注度和优先级。在其项目简介中有这么一段描述：

> At this time installers must either be MSIX, MSI or .exe application installers. Compressed .zip files and fonts are not currently supported.

不难理解，毕竟 MSIX 是微软目前主推的应用部署方式，与 Windows 发展的大方向相契合。但对于以开发者为主的一部分 Windows 用户而言，我们经常会用到一些以二进制包的形式分发的软件，winget 并不适用于管理这些软件。

## 理想的包管理

在浏览了众多优秀的开源项目并反复思考个人需求后，我心目中的 Windows 包管理是这样的：

- 足够快速，架构简单；
- 主要面向开发者；
- 作为 winget 的互补，管理以二进制包形式分发的软件；
- 尽量不留历史包袱，在相当长的一段时间内不承诺无破坏性修改；
- 开放，积极接收来自社区的活跃开发中的项目。

可见，Xepod 的定位非常明确，将“包管理”这一话题限定在诸多条件之内。这可能无法迎合大多数人的需求，但我想先满足这一可能小众的需求，并努力把它做好。

如果觉得 Xepod 并不能满足您，建议看一看 [Scoop](https://scoop.sh) 。
